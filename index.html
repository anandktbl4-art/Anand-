<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>Camera + Dashboard</title>

<!-- CSS PART 2 à²‡à²²à³à²²à²¿ later à²¹à²¾à²•à³à²¤à³à²¤à³‡à²µà³† -->
<style></style>

</head>
<body>

<!----------------------------->
<!--   CAMERA SECTION FIRST  -->
<!----------------------------->

<h2>ğŸ“¸ Camera App</h2>

<video id="video" autoplay playsinline></video>

<div class="cam-buttons">
    <button onclick="takePhoto()">ğŸ“· Photo</button>
    <button onclick="startRec()">âº Video Record</button>
    <button onclick="stopRec()">â¹ Stop</button>
</div>

<a id="downloadLink"></a>

<canvas id="canvas" style="display:none;"></canvas>

<hr>


<!-------------------------------->
<!--   VISITOR DASHBOARD BELOW  -->
<!-------------------------------->

<h2>ğŸ§¾ Visitor Intelligence Dashboard</h2>

<p id="device"></p>
<p id="browser"></p>
<p id="battery"></p>
<p id="network"></p>
<p id="ram"></p>
<p id="screen"></p>
<p id="orientation"></p>

<p id="ip"></p>
<p id="location"></p>
<p id="gps"></p>

<p id="visits"></p>
<p id="clicks"></p>

<h3>ğŸ—º Live Map</h3>
<iframe id="map"></iframe>

<!-- PART 3 JS à²‡à²²à³à²²à²¿à²—à³† à²¹à²¾à²•à³à²¤à³à²¤à³‡à²µà³† -->
<script></script>

</body>
</html>/* CAMERA AREA */
#video{
    width:100%;
    height:60vh;
    background:#000;
    object-fit:cover;
    border:2px solid #00ff00;
}

.cam-buttons button{
    padding:10px 18px;
    margin:8px;
    background:#00ff00;
    color:#000;
    font-weight:bold;
    border:none;
    border-radius:10px;
    font-size:18px;
    cursor:pointer;
}

#downloadLink{
    display:block;
    margin-top:10px;
    font-size:18px;
    color:#00ff00;
}

/* DASHBOARD */
body{
    background:#000;
    color:#00ff00;
    font-family:Consolas, monospace;
    text-align:center;
    padding:15px;
}

iframe{
    width:100%;
    height:250px;
    border:2px solid #00ff00;
}

p{
    font-size:18px;
}/* ------------------ CAMERA FUNCTIONS ------------------ */

let stream;
let recorder;
let chunks = [];

// START CAMERA
async function startCamera(){
    stream = await navigator.mediaDevices.getUserMedia({
        video:true,
        audio:true
    });
    document.getElementById("video").srcObject = stream;
}
startCamera();

// TAKE PHOTO
function takePhoto(){
    let video = document.getElementById("video");
    let canvas = document.getElementById("canvas");

    canvas.width = video.videoWidth;
    canvas.height = video.videoHeight;

    canvas.getContext("2d").drawImage(video,0,0);

    let imgURL = canvas.toDataURL("image/png");

    let link = document.getElementById("downloadLink");
    link.href = imgURL;
    link.download = "photo.png";
    link.innerText = "â¬‡ Download Photo";
}

// START VIDEO RECORD
function startRec(){
    chunks=[];
    recorder = new MediaRecorder(stream);
    recorder.ondataavailable = e => chunks.push(e.data);
    recorder.onstop = saveVideo;
    recorder.start();
    alert("ğŸ¥ Recording started");
}

// STOP VIDEO RECORD
function stopRec(){
    recorder.stop();
    alert("ğŸ“ Recording stopped");
}

// CREATE VIDEO FILE
function saveVideo(){
    let blob = new Blob(chunks, {type:"video/mp4"});
    let url = URL.createObjectURL(blob);

    let link = document.getElementById("downloadLink");
    link.href = url;
    link.download = "video.mp4";
    link.innerText = "â¬‡ Download Video";
}

/* ------------------ VISITOR DATA FUNCTIONS ------------------ */

// DEVICE INFO
document.getElementById("device").innerText = "Device: " + navigator.platform;
document.getElementById("browser").innerText = "Browser: " + navigator.userAgent;

// BATTERY
if (navigator.getBattery){
    navigator.getBattery().then(b=>{
        document.getElementById("battery").innerText =
            "Battery: " + Math.round(b.level*100) + "%";
    });
}

// NETWORK TYPE
if (navigator.connection){
    document.getElementById("network").innerText =
        "Network: " + navigator.connection.effectiveType;
}

// RAM
if (navigator.deviceMemory){
    document.getElementById("ram").innerText =
        "RAM: " + navigator.deviceMemory + " GB";
}

// SCREEN INFO
document.getElementById("screen").innerText =
    "Screen: " + window.screen.width + " Ã— " + window.screen.height;

// ORIENTATION
document.getElementById("orientation").innerText =
    "Orientation: " + (screen.orientation.type || "Unknown");

// VISIT COUNTER
let visit = localStorage.getItem("visits") || 0;
visit++;
localStorage.setItem("visits", visit);
document.getElementById("visits").innerText = "Total Visits: " + visit;

// CLICK COUNTER
let clicks = 0;
document.addEventListener("click",()=>{
    clicks++;
    document.getElementById("clicks").innerText = "Screen Clicks: " + clicks;
});

// IP + CITY/STATE INFO
fetch("https://api.ipify.org?format=json")
.then(r=>r.json())
.then(ip=>{
    document.getElementById("ip").innerText = "IP: " + ip.ip;

    return fetch("https://ipapi.co/json/");
})
.then(r=>r.json())
.then(loc=>{
    document.getElementById("location").innerText =
        "Location: " + loc.city + ", " + loc.region + ", " + loc.country_name;

    document.getElementById("map").src =
        `https://maps.google.com/maps?q=${loc.latitude},${loc.longitude}&z=14&output=embed`;
});

// GPS LIVE LOCATION
if (navigator.geolocation){
    navigator.geolocation.watchPosition(pos=>{
        document.getElementById("gps").innerText =
            "GPS: " + pos.coords.latitude.toFixed(5) + ", " + pos.coords.longitude.toFixed(5);
    });
}
